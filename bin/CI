#!/bin/bash
set -e
set -o pipefail

THIS=$(basename "$0" | cut -d. -f1)
DEP_DIR="$BAO_BASE_LIB_DIR/$THIS"

if [[ "$1" == "all" ]]; then
    shift
    WORKFLOW=.github/workflows/CI-test-foundry.yml
    EVENT=$DEP_DIR/workflow_dispatch.json
else
    WORKFLOW=$DEP_DIR/local-test-foundry.yml
    EVENT=$DEP_DIR/ubuntu_workflow_dispatch_latest.json
fi

echo gh act --directory $BAO_BASE_DIR -P ubuntu-latest=-self-hosted -W $WORKFLOW -e $EVENT $@
gh act --directory $BAO_BASE_DIR -P ubuntu-latest=-self-hosted -W $WORKFLOW -e $EVENT $@
